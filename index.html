<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üì± ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .main-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .scan-section {
            text-align: center;
        }

        #scanInput {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            border: 3px solid #667eea;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        #scanInput:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .scan-icon {
            font-size: 5em;
            margin: 20px 0;
        }

        .result-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
            animation: slideIn 0.3s ease-out;
        }

        .result-box.error {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        }

        .result-box.duplicate {
            background: linear-gradient(135deg, #ffa726 0%, #fb8c00 100%);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-box.show {
            display: block;
        }

        .result-item {
            margin: 10px 0;
            font-size: 1.2em;
        }

        .result-item strong {
            display: inline-block;
            width: 150px;
        }

        .duplicate-warning {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 1.1em;
            font-weight: bold;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .manual-input-section {
            background: #fff3cd;
            border: 3px solid #ffc107;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .manual-input-section.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        .manual-input-section h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .manual-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #manualInput {
            flex: 1;
            padding: 12px;
            font-size: 1.1em;
            border: 2px solid #ffc107;
            border-radius: 8px;
        }

        .upload-area {
            border: 3px dashed #667eea;
            padding: 40px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
            position: relative;
        }

        .upload-area:hover {
            background: #f0f4ff;
            border-color: #764ba2;
            transform: translateY(-2px);
        }

        .upload-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        .upload-area h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .upload-area p {
            color: #666;
            margin-top: 10px;
            line-height: 1.6;
        }

        input[type="file"] {
            display: none;
        }

        .saved-databases {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .saved-databases h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .database-item {
            background: white;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }

        .database-item:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }

        .database-item.active {
            border-color: #38ef7d;
            background: #f0fff4;
        }

        .database-info {
            flex: 1;
        }

        .database-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 3px;
        }

        .database-count {
            font-size: 0.9em;
            color: #666;
        }

        .database-actions {
            display: flex;
            gap: 5px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.9em;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-load {
            background: #667eea;
            color: white;
        }

        .btn-load:hover {
            background: #5568d3;
        }

        .btn-delete {
            background: #ff6b6b;
            color: white;
        }

        .btn-delete:hover {
            background: #ee5a6f;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 100%;
            margin-top: 10px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            width: 100%;
            margin-top: 10px;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(56, 239, 125, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 12px 25px;
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(245, 87, 108, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            padding: 12px 25px;
        }

        .btn-info {
            background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
            color: white;
            width: 100%;
            margin-top: 10px;
        }

        .btn-info:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(58, 123, 213, 0.4);
        }

        .data-table {
            width: 100%;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            position: sticky;
            top: 0;
        }

        tr:hover {
            background: #f0f4ff;
        }

        tr.duplicate-row {
            background: #fff3cd;
        }

        .status-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .status-success {
            background: #38ef7d;
            color: white;
        }

        .status-manual {
            background: #ffc107;
            color: #000;
        }

        .status-duplicate {
            background: #ff9800;
            color: white;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card.warning {
            background: linear-gradient(135deg, #ffa726 0%, #fb8c00 100%);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 20px 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
            z-index: 1000;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .notification.show {
            display: block;
        }

        .notification.success {
            border-left: 5px solid #38ef7d;
        }

        .notification.error {
            border-left: 5px solid #ff6b6b;
        }

        .notification.warning {
            border-left: 5px solid #ffc107;
        }

        .notification.duplicate {
            border-left: 5px solid #ff9800;
        }

        .bad-id-warning {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            color: #856404;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .empty-state {
            text-align: center;
            padding: 20px;
            color: #999;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .main-section {
                grid-template-columns: 1fr;
            }

            .stats {
                grid-template-columns: 1fr 1fr;
            }

            .manual-input-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }

            .button-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>
                üì± ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            </h1>
            <p>‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ - Export Excel</p>
        </div>

        <!-- Main Section -->
        <div class="main-section">
            <!-- Scan Section -->
            <div class="card scan-section">
                <h2>üîç ‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç</h2>
                <div class="scan-icon">üì∑</div>
                <input type="text" id="scanInput" placeholder="‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." autofocus>
                <p style="color: #666; margin-top: 10px;">
                    üí° ‡∏ß‡∏≤‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏•‡∏¢
                </p>

                <!-- Result Box -->
                <div class="result-box" id="resultBox">
                    <div class="result-item">
                        <strong>‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</strong>
                        <span id="resultEmpId">-</span>
                    </div>
                    <div class="result-item">
                        <strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</strong>
                        <span id="resultName">-</span>
                    </div>
                    <div class="result-item">
                        <strong>BAD ID:</strong>
                        <span id="resultBadId">-</span>
                    </div>
                    <div class="result-item">
                        <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πÅ‡∏Å‡∏ô:</strong>
                        <span id="resultDate">-</span>
                    </div>
                    <div class="result-item">
                        <strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong>
                        <span id="resultTime">-</span>
                    </div>
                    <div class="duplicate-warning" id="duplicateWarning" style="display: none;">
                        ‚ö†Ô∏è ‡∏ã‡πâ‡∏≥! ‡πÄ‡∏Ñ‡∏¢‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏°‡∏∑‡πà‡∏≠ <span id="previousScanTime">-</span>
                    </div>
                </div>

                <!-- Manual Input Section -->
                <div class="manual-input-section" id="manualInputSection">
                    <h3>‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö - ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á</h3>
                    <div class="bad-id-warning">
                        <strong>BAD ID ‡∏ó‡∏µ‡πà‡∏™‡πÅ‡∏Å‡∏ô:</strong> <span id="badIdScanned">-</span>
                    </div>
                    <div class="manual-input-group">
                        <input type="text" id="manualInput" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 10 ‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏ä‡πà‡∏ô 1000336245)">
                        <button class="btn btn-warning" onclick="submitManualInput()">‚úì ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
                        <button class="btn btn-secondary" onclick="cancelManualInput()">‚úï ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    </div>
                </div>
            </div>

            <!-- Upload Section -->
            <div class="card">
                <h2>üì§ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                
                <!-- Saved Databases -->
                <div class="saved-databases" id="savedDatabasesContainer">
                    <h4>üíæ ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</h4>
                    <div id="savedDatabasesList">
                        <div class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</div>
                    </div>
                </div>

                <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-icon">üìÅ</div>
                    <h3>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel</h3>
                    <p>
                        ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå .xlsx ‡πÅ‡∏•‡∏∞ .xls<br>
                        (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå: <strong>‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô, ‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•, BAD ID</strong>)
                    </p>
                    <input type="file" id="fileInput" accept=".xlsx,.xls">
                </div>
                <div id="uploadStatus" style="text-align: center; color: #667eea; font-weight: bold; margin-bottom: 15px;"></div>

                <div class="button-group">
                    <button class="btn btn-success" onclick="downloadTemplate()">
                        üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                    </button>
                    <button class="btn btn-primary" onclick="loadSampleData()">
                        üìã ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                    </button>
                </div>
                
                <button class="btn btn-info" onclick="saveCurrentDatabase()" id="saveDbBtn" style="display: none;">
                    üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
                </button>
            </div>
        </div>

        <!-- Statistics -->
        <div class="card">
            <h2>üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</h2>
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalScans">0</div>
                    <div class="stat-label">‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡πÅ‡∏Å‡∏ô (‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥)</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-number" id="duplicateScans">0</div>
                    <div class="stat-label">‡∏™‡πÅ‡∏Å‡∏ô‡∏ã‡πâ‡∏≥</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="databaseCount">0</div>
                    <div class="stat-label">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="todayScans">0</div>
                    <div class="stat-label">‡∏™‡πÅ‡∏Å‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                </div>
            </div>
        </div>

        <!-- Data Table -->
        <div class="card">
            <h2>üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏™‡πÅ‡∏Å‡∏ô</h2>
            <button class="btn btn-success" onclick="exportToExcel()">
                üìä Export ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Excel
            </button>
            <div class="data-table">
                <table>
                    <thead>
                        <tr>
                            <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th>‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th>BAD ID</th>
                            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 40px; color: #999;">
                                ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏•‡∏¢!
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // Global Variables
        let database = [];
        let scannedRecords = [];
        let duplicateScans = [];
        let currentBadId = '';
        let savedDatabases = [];
        let currentDatabaseName = '';

        // Sample Data
        const sampleData = [
            { empId: '1000336245', name: '‡πÄ‡∏Å‡∏®‡∏°‡∏¥‡∏Å‡∏≤ ‡∏ö‡∏∏‡∏ç‡∏™‡πà‡∏á', badId: '2600870898' },
            { empId: '1000336239', name: '‡πÄ‡∏Å‡∏®‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå ‡∏≠‡∏±‡∏ô‡∏≠‡∏¥‡πà‡∏°', badId: '2604470466' },
            { empId: '1000336423', name: '‡πÄ‡∏Å‡∏™ ‡πÄ‡∏ã‡∏µ‡∏¢‡∏á‡∏á‡∏ß‡∏á', badId: '2598123138' },
            { empId: '1000336173', name: '‡πÄ‡∏Ç‡∏°‡∏à‡∏¥‡∏£‡∏≤ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏≤', badId: '3707100598' },
            { empId: '1000336282', name: '‡πÄ‡∏à‡∏ô‡∏à‡∏¥‡∏£‡∏≤ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ', badId: '3707307574' },
            { empId: '1000336213', name: '‡πÄ‡∏ô‡∏ï‡∏£‡∏ô‡∏†‡∏≤ ‡πÅ‡∏™‡∏á‡∏Å‡∏•', badId: '2596799554' },
            { empId: '1000336327', name: '‡πÄ‡∏ô‡∏ç‡∏à‡∏ô‡∏≤‡∏†‡∏£‡∏ì‡πå ‡πÄ‡∏ß‡∏ä‡∏£‡∏û‡∏£‡∏ó‡∏ß‡∏µ', badId: '3711046486' }
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            loadSavedDatabases();
            updateStats();
            updateSavedDatabasesList();
            
            // Setup file input
            document.getElementById('fileInput').addEventListener('change', handleFileUpload);
            
            // Setup scan input
            const scanInput = document.getElementById('scanInput');
            scanInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    processScan(scanInput.value.trim());
                }
            });

            // Setup manual input
            const manualInput = document.getElementById('manualInput');
            manualInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    submitManualInput();
                }
            });
        });

        // Save current database
        function saveCurrentDatabase() {
            if (database.length === 0) {
                showNotification('‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å', 'error');
                return;
            }

            const dbName = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', currentDatabaseName || '‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ' + new Date().toLocaleDateString('th-TH'));
            
            if (!dbName) return;

            const dbId = Date.now().toString();
            const newDatabase = {
                id: dbId,
                name: dbName,
                data: [...database],
                count: database.length,
                savedDate: new Date().toLocaleString('th-TH')
            };

            // Check if name exists
            const existingIndex = savedDatabases.findIndex(db => db.name === dbName);
            if (existingIndex >= 0) {
                if (confirm('‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    savedDatabases[existingIndex] = newDatabase;
                } else {
                    return;
                }
            } else {
                savedDatabases.push(newDatabase);
            }

            currentDatabaseName = dbName;
            localStorage.setItem('savedDatabases', JSON.stringify(savedDatabases));
            updateSavedDatabasesList();
            showNotification('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // Load saved database
        function loadSavedDatabase(dbId) {
            const db = savedDatabases.find(d => d.id === dbId);
            if (!db) return;

            database = [...db.data];
            currentDatabaseName = db.name;
            saveToLocalStorage();
            updateStats();
            updateSavedDatabasesList();
            
            document.getElementById('uploadStatus').innerHTML = 
                `‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "<strong>${db.name}</strong>" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${db.count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
            
            showNotification('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // Delete saved database
        function deleteSavedDatabase(dbId) {
            const db = savedDatabases.find(d => d.id === dbId);
            if (!db) return;

            if (!confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "${db.name}" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) return;

            savedDatabases = savedDatabases.filter(d => d.id !== dbId);
            localStorage.setItem('savedDatabases', JSON.stringify(savedDatabases));
            updateSavedDatabasesList();
            showNotification('‚úÖ ‡∏•‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // Update saved databases list
        function updateSavedDatabasesList() {
            const container = document.getElementById('savedDatabasesList');
            const saveBtn = document.getElementById('saveDbBtn');
            
            // Show/hide save button
            saveBtn.style.display = database.length > 0 ? 'block' : 'none';

            if (savedDatabases.length === 0) {
                container.innerHTML = '<div class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</div>';
                return;
            }

            container.innerHTML = savedDatabases.map(db => `
                <div class="database-item ${currentDatabaseName === db.name ? 'active' : ''}">
                    <div class="database-info">
                        <div class="database-name">${db.name}</div>
                        <div class="database-count">${db.count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‚Ä¢ ${db.savedDate}</div>
                    </div>
                    <div class="database-actions">
                        <button class="btn-small btn-load" onclick="loadSavedDatabase('${db.id}')">‡πÇ‡∏´‡∏•‡∏î</button>
                        <button class="btn-small btn-delete" onclick="deleteSavedDatabase('${db.id}')">‡∏•‡∏ö</button>
                    </div>
                </div>
            `).join('');
        }

        // Load saved databases from localStorage
        function loadSavedDatabases() {
            const saved = localStorage.getItem('savedDatabases');
            if (saved) {
                savedDatabases = JSON.parse(saved);
            }
        }

        // Load sample data
        function loadSampleData() {
            database = [...sampleData];
            currentDatabaseName = '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á';
            saveToLocalStorage();
            updateStats();
            updateSavedDatabasesList();
            
            document.getElementById('uploadStatus').innerHTML = 
                `‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: <strong>${database.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</strong>`;
            
            showNotification('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // Process scan
        function processScan(scannedId) {
            if (!scannedId) return;

            const scanInput = document.getElementById('scanInput');
            currentBadId = scannedId;

            // Hide previous results
            document.getElementById('resultBox').classList.remove('show');
            document.getElementById('manualInputSection').classList.remove('show');

            // Try to find by employee ID first
            let person = database.find(p => p.empId === scannedId);
            
            // If not found, try to find by BAD ID
            if (!person) {
                person = database.find(p => p.badId === scannedId);
            }

            if (!person) {
                // Show manual input section
                showManualInput(scannedId);
                scanInput.value = '';
                return;
            }

            // Check for duplicate (same employee ID scanned today)
            const today = new Date().toLocaleDateString('th-TH');
            const existingRecord = scannedRecords.find(r => 
                r.empId === person.empId && r.date === today
            );

            if (existingRecord) {
                // Duplicate scan - show but don't count
                showDuplicateResult(person, existingRecord);
                
                // Add to duplicate list
                const now = new Date();
                duplicateScans.push({
                    empId: person.empId,
                    name: person.name,
                    badId: person.badId,
                    date: now.toLocaleDateString('th-TH'),
                    time: now.toLocaleTimeString('th-TH'),
                    timestamp: now.getTime()
                });
                
                saveToLocalStorage();
                updateStats();
            } else {
                // New scan - create record
                createRecord(person.empId, person.name, person.badId, 'auto');
            }

            scanInput.value = '';
            
            // Refocus input
            setTimeout(() => scanInput.focus(), 100);
        }

        // Show duplicate result
        function showDuplicateResult(person, existingRecord) {
            document.getElementById('resultEmpId').textContent = person.empId;
            document.getElementById('resultName').textContent = person.name;
            document.getElementById('resultBadId').textContent = person.badId;
            
            const now = new Date();
            document.getElementById('resultDate').textContent = now.toLocaleDateString('th-TH');
            document.getElementById('resultTime').textContent = now.toLocaleTimeString('th-TH');
            
            // Show duplicate warning
            document.getElementById('previousScanTime').textContent = 
                `${existingRecord.date} ‡πÄ‡∏ß‡∏•‡∏≤ ${existingRecord.time}`;
            document.getElementById('duplicateWarning').style.display = 'block';
            
            const resultBox = document.getElementById('resultBox');
            resultBox.classList.remove('error');
            resultBox.classList.add('duplicate');
            resultBox.classList.remove('show');
            setTimeout(() => resultBox.classList.add('show'), 10);

            showNotification(`‚ö†Ô∏è ‡∏ã‡πâ‡∏≥! ${person.name} ‡πÄ‡∏Ñ‡∏¢‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏•‡πâ‡∏ß`, 'duplicate');
        }

        // Show manual input
        function showManualInput(badId) {
            document.getElementById('badIdScanned').textContent = badId;
            document.getElementById('manualInputSection').classList.add('show');
            document.getElementById('manualInput').value = '';
            document.getElementById('manualInput').focus();
            
            showNotification('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö - ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô', 'warning');
        }

        // Submit manual input
        function submitManualInput() {
            const manualEmpId = document.getElementById('manualInput').value.trim();
            
            if (!manualEmpId) {
                showNotification('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô', 'error');
                return;
            }

            // Find person by employee ID
            const person = database.find(p => p.empId === manualEmpId);
            
            if (!person) {
                showNotification('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö', 'error');
                return;
            }

            // Check for duplicate
            const today = new Date().toLocaleDateString('th-TH');
            const existingRecord = scannedRecords.find(r => 
                r.empId === person.empId && r.date === today
            );

            if (existingRecord) {
                // Duplicate scan
                showDuplicateResult(person, existingRecord);
                
                // Add to duplicate list
                const now = new Date();
                duplicateScans.push({
                    empId: person.empId,
                    name: person.name,
                    badId: currentBadId,
                    date: now.toLocaleDateString('th-TH'),
                    time: now.toLocaleTimeString('th-TH'),
                    timestamp: now.getTime()
                });
                
                saveToLocalStorage();
                updateStats();
            } else {
                // Create record with manual entry
                createRecord(person.empId, person.name, currentBadId, 'manual');
            }
            
            // Hide manual input section
            document.getElementById('manualInputSection').classList.remove('show');
            
            // Refocus scan input
            document.getElementById('scanInput').focus();
        }

        // Cancel manual input
        function cancelManualInput() {
            document.getElementById('manualInputSection').classList.remove('show');
            document.getElementById('scanInput').focus();
            currentBadId = '';
        }

        // Create record
        function createRecord(empId, name, badId, type) {
            const now = new Date();
            const date = now.toLocaleDateString('th-TH');
            const time = now.toLocaleTimeString('th-TH');

            const record = {
                empId: empId,
                name: name,
                badId: badId,
                date: date,
                time: time,
                timestamp: now.getTime(),
                type: type // 'auto' or 'manual'
            };

            // Add to records
            scannedRecords.unshift(record);
            
            // Save to localStorage
            saveToLocalStorage();

            // Show result
            showResult(record);

            // Update table
            updateTable();

            // Update stats
            updateStats();

            // Show notification
            const message = type === 'manual' 
                ? '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (Manual): ' + record.name
                : '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + record.name;
            showNotification(message, 'success');
        }

        // Show result
        function showResult(record) {
            document.getElementById('resultEmpId').textContent = record.empId;
            document.getElementById('resultName').textContent = record.name;
            document.getElementById('resultBadId').textContent = record.badId;
            document.getElementById('resultDate').textContent = record.date;
            document.getElementById('resultTime').textContent = record.time;
            
            // Hide duplicate warning
            document.getElementById('duplicateWarning').style.display = 'none';
            
            const resultBox = document.getElementById('resultBox');
            resultBox.classList.remove('error');
            resultBox.classList.remove('duplicate');
            resultBox.classList.remove('show');
            setTimeout(() => resultBox.classList.add('show'), 10);
        }

        // Handle file upload
        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet);

                    // Process data
                    database = jsonData.map(row => ({
                        empId: String(row['‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô'] || row['‡∏£‡∏´‡∏±‡∏™'] || row['ID'] || '').trim(),
                        name: String(row['‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•'] || row['‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•'] || row['Name'] || '').trim(),
                        badId: String(row['BAD ID'] || row['BadID'] || row['BADID'] || '').trim()
                    })).filter(item => item.empId && item.name);

                    currentDatabaseName = file.name.replace(/\.[^/.]+$/, '');
                    saveToLocalStorage();
                    updateStats();
                    updateSavedDatabasesList();
                    
                    document.getElementById('uploadStatus').innerHTML = 
                        `‚úÖ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: <strong>${database.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</strong>`;
                    
                    showNotification('‚úÖ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                } catch (error) {
                    console.error('Error:', error);
                    showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå', 'error');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // Update table
        function updateTable() {
            const tbody = document.getElementById('dataTableBody');
            
            if (scannedRecords.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: #999;">
                            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏•‡∏¢!
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = scannedRecords.map((record, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td>${record.empId}</td>
                    <td>${record.name}</td>
                    <td>${record.badId}</td>
                    <td>${record.date}</td>
                    <td>${record.time}</td>
                    <td>
                        <span class="status-badge ${record.type === 'manual' ? 'status-manual' : 'status-success'}">
                            ${record.type === 'manual' ? '‚úé Manual' : '‚úì Auto'}
                        </span>
                    </td>
                </tr>
            `).join('');
        }

        // Update statistics
        function updateStats() {
            document.getElementById('totalScans').textContent = scannedRecords.length;
            document.getElementById('duplicateScans').textContent = duplicateScans.length;
            document.getElementById('databaseCount').textContent = database.length;
            
            const today = new Date().toLocaleDateString('th-TH');
            const todayScans = scannedRecords.filter(r => r.date === today).length;
            document.getElementById('todayScans').textContent = todayScans;
        }

        // Export to Excel
        function exportToExcel() {
            if (scannedRecords.length === 0) {
                showNotification('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ Export', 'error');
                return;
            }

            const exportData = scannedRecords.map((record, index) => ({
                '‡∏•‡∏≥‡∏î‡∏±‡∏ö': index + 1,
                '‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô': record.empId,
                '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•': record.name,
                'BAD ID': record.badId,
                '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà': record.date,
                '‡πÄ‡∏ß‡∏•‡∏≤': record.time,
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': record.type === 'manual' ? 'Manual Input' : 'Auto Scan'
            }));

            const ws = XLSX.utils.json_to_sheet(exportData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô");

            ws['!cols'] = [
                { wch: 8 }, { wch: 15 }, { wch: 25 }, 
                { wch: 15 }, { wch: 15 }, { wch: 12 }, { wch: 15 }
            ];

            const fileName = `‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô_${new Date().toLocaleDateString('th-TH').replace(/\//g, '-')}.xlsx`;
            XLSX.writeFile(wb, fileName);

            showNotification('‚úÖ Export ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // Download template
        function downloadTemplate() {
            const ws = XLSX.utils.json_to_sheet(sampleData.map(item => ({
                '‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô': item.empId,
                '‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•': item.name,
                'BAD ID': item.badId
            })));
            
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");

            ws['!cols'] = [{ wch: 15 }, { wch: 25 }, { wch: 15 }];

            XLSX.writeFile(wb, '‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•.xlsx');
            showNotification('‚úÖ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Local Storage
        function saveToLocalStorage() {
            localStorage.setItem('database', JSON.stringify(database));
            localStorage.setItem('currentDatabaseName', currentDatabaseName);
            localStorage.setItem('scannedRecords', JSON.stringify(scannedRecords));
            localStorage.setItem('duplicateScans', JSON.stringify(duplicateScans));
        }

        function loadFromLocalStorage() {
            const savedDatabase = localStorage.getItem('database');
            const savedDbName = localStorage.getItem('currentDatabaseName');
            const savedRecords = localStorage.getItem('scannedRecords');
            const savedDuplicates = localStorage.getItem('duplicateScans');
            
            if (savedDatabase) {
                database = JSON.parse(savedDatabase);
            }

            if (savedDbName) {
                currentDatabaseName = savedDbName;
            }
            
            if (savedRecords) {
                scannedRecords = JSON.parse(savedRecords);
                updateTable();
            }

            if (savedDuplicates) {
                duplicateScans = JSON.parse(savedDuplicates);
            }
        }
    </script>
</body>
</html>
